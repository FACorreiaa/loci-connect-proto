syntax = "proto3";

package loci.favorites.v1;

option go_package = "github.com/FACorreiaa/loci-connect-proto/gen/go/loci/favorites/v1;favoritesv1";

import "google/protobuf/timestamp.proto";
import "buf/validate/validate.proto";

// Content type for favorites
enum ContentType {
  CONTENT_TYPE_UNSPECIFIED = 0;
  CONTENT_TYPE_POI = 1;
  CONTENT_TYPE_HOTEL = 2;
  CONTENT_TYPE_RESTAURANT = 3;
  CONTENT_TYPE_ITINERARY = 4;
}

// Favorite item representation
message FavoriteItem {
  string id = 1;
  string user_id = 2;
  string item_id = 3;  // The ID of the POI/hotel/restaurant/itinerary
  string item_name = 4;
  ContentType content_type = 5;
  string notes = 6;
  string description = 7;
  string city_name = 8;
  double latitude = 9;
  double longitude = 10;
  double rating = 11;
  string category = 12;
  google.protobuf.Timestamp added_at = 13;
}

// FavoritesService provides favorites management functionality
service FavoritesService {
  // Add an item to favorites
  rpc AddToFavorites(AddToFavoritesRequest) returns (AddToFavoritesResponse);
  
  // Remove an item from favorites
  rpc RemoveFromFavorites(RemoveFromFavoritesRequest) returns (RemoveFromFavoritesResponse);
  
  // Get all favorites for a user
  rpc GetFavorites(GetFavoritesRequest) returns (GetFavoritesResponse);
  
  // Check if an item is favorited
  rpc IsFavorited(IsFavoritedRequest) returns (IsFavoritedResponse);
  
  // Get favorites count
  rpc GetFavoritesCount(GetFavoritesCountRequest) returns (GetFavoritesCountResponse);
  
  // Get hotel details
  rpc GetHotelDetails(GetHotelDetailsRequest) returns (GetHotelDetailsResponse);
  
  // Get restaurant details
  rpc GetRestaurantDetails(GetRestaurantDetailsRequest) returns (GetRestaurantDetailsResponse);
  
  // Get nearby hotels
  rpc GetNearbyHotels(GetNearbyHotelsRequest) returns (GetNearbyHotelsResponse);
  
  // Get nearby restaurants
  rpc GetNearbyRestaurants(GetNearbyRestaurantsRequest) returns (GetNearbyRestaurantsResponse);
}

// AddToFavorites
message AddToFavoritesRequest {
  string user_id = 1 [(buf.validate.field).string.min_len = 1];
  string item_id = 2 [(buf.validate.field).string.min_len = 1];
  string item_name = 3;
  ContentType content_type = 4;
  string notes = 5;
  string description = 6;
  string city_name = 7;
  double latitude = 8;
  double longitude = 9;
  double rating = 10;
  string category = 11;
  string llm_interaction_id = 12;  // Optional: link to LLM interaction
}

message AddToFavoritesResponse {
  bool success = 1;
  string message = 2;
  FavoriteItem favorite = 3;
}

// RemoveFromFavorites
message RemoveFromFavoritesRequest {
  string user_id = 1 [(buf.validate.field).string.min_len = 1];
  string item_id = 2 [(buf.validate.field).string.min_len = 1];
  ContentType content_type = 3;
}

message RemoveFromFavoritesResponse {
  bool success = 1;
  string message = 2;
}

// GetFavorites
message GetFavoritesRequest {
  string user_id = 1 [(buf.validate.field).string.min_len = 1];
  ContentType content_type = 2;  // Optional: filter by type (0 = all)
  int32 limit = 3;
  int32 offset = 4;
}

message GetFavoritesResponse {
  repeated FavoriteItem favorites = 1;
  int32 total_count = 2;
}

// IsFavorited
message IsFavoritedRequest {
  string user_id = 1 [(buf.validate.field).string.min_len = 1];
  string item_id = 2 [(buf.validate.field).string.min_len = 1];
  ContentType content_type = 3;
}

message IsFavoritedResponse {
  bool is_favorited = 1;
}

// GetFavoritesCount
message GetFavoritesCountRequest {
  string user_id = 1 [(buf.validate.field).string.min_len = 1];
  ContentType content_type = 2;  // Optional: filter by type (0 = all)
}

message GetFavoritesCountResponse {
  int32 count = 1;
}

// ==================
// HOTEL DETAILS
// ==================

message HotelDetails {
  string id = 1;
  string name = 2;
  string city = 3;
  string description = 4;
  double latitude = 5;
  double longitude = 6;
  string address = 7;
  string category = 8;
  double rating = 9;
  string star_rating = 10;
  string price_range = 11;
  repeated string amenities = 12;
  repeated string images = 13;
  string phone = 14;
  string website = 15;
  string llm_interaction_id = 16;
  google.protobuf.Timestamp created_at = 17;
  
  // Extended fields for detail page
  string check_in = 18;
  string check_out = 19;
  string price_per_night = 20;
  int32 review_count = 21;
  repeated string features = 22;
  repeated HotelRoom rooms = 23;
  repeated NearbyAttraction nearby_attractions = 24;
  HotelContact contact = 25;
}

message HotelRoom {
  string type = 1;
  string description = 2;
  string price = 3;
  string size = 4;
  string capacity = 5;
  repeated string amenities = 6;
}

message NearbyAttraction {
  string name = 1;
  string type = 2;
  string distance = 3;
}

message HotelContact {
  string phone = 1;
  string email = 2;
  string website = 3;
}

message GetHotelDetailsRequest {
  string hotel_id = 1 [(buf.validate.field).string.min_len = 1];
}

message GetHotelDetailsResponse {
  bool success = 1;
  string message = 2;
  HotelDetails hotel = 3;
}

message GetNearbyHotelsRequest {
  double latitude = 1;
  double longitude = 2;
  double radius_km = 3;  // Optional, default 5km
  int32 limit = 4;       // Optional, default 20
}

message GetNearbyHotelsResponse {
  repeated HotelDetails hotels = 1;
  int32 total_count = 2;
}

// ==================
// RESTAURANT DETAILS
// ==================

message RestaurantDetails {
  string id = 1;
  string name = 2;
  string city = 3;
  string description = 4;
  double latitude = 5;
  double longitude = 6;
  string address = 7;
  string category = 8;
  double rating = 9;
  string cuisine_type = 10;
  string price_range = 11;
  repeated string tags = 12;
  repeated string images = 13;
  string phone = 14;
  string website = 15;
  string llm_interaction_id = 16;
  google.protobuf.Timestamp created_at = 17;
  
  // Extended fields for detail page
  int32 review_count = 18;
  bool is_open = 19;
  bool reservation_required = 20;
  bool accepts_cards = 21;
  repeated string features = 22;
  repeated string specialties = 23;
  repeated string languages = 24;
  string average_price = 25;
  RestaurantMenu menu = 26;
  map<string, string> hours = 27;
  RestaurantContact contact = 28;
}

message MenuItem {
  string name = 1;
  string description = 2;
  string price = 3;
}

message RestaurantMenu {
  repeated MenuItem starters = 1;
  repeated MenuItem mains = 2;
  repeated MenuItem desserts = 3;
}

message RestaurantContact {
  string phone = 1;
  string email = 2;
  string website = 3;
}

message GetRestaurantDetailsRequest {
  string restaurant_id = 1 [(buf.validate.field).string.min_len = 1];
}

message GetRestaurantDetailsResponse {
  bool success = 1;
  string message = 2;
  RestaurantDetails restaurant = 3;
}

message GetNearbyRestaurantsRequest {
  double latitude = 1;
  double longitude = 2;
  double radius_km = 3;  // Optional, default 5km
  int32 limit = 4;       // Optional, default 20
}

message GetNearbyRestaurantsResponse {
  repeated RestaurantDetails restaurants = 1;
  int32 total_count = 2;
}
