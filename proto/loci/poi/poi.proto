syntax = "proto3";

package loci.poi;

option go_package = "github.com/FACorreiaa/loci-connect-proto/gen/go/loci/poi;poi";


import "buf/validate/validate.proto";
import "google/protobuf/timestamp.proto";
import "proto/loci/common/common.proto";

// POIDetailedInfo represents a point of interest
message POIDetailedInfo {
  string id = 1 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
  string city = 2 [(buf.validate.field).string = {min_len: 1, max_len: 200}];
  string city_id = 3 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
  string name = 4 [(buf.validate.field).string = {min_len: 1, max_len: 300}];
  optional string description_poi = 5 [(buf.validate.field).string = {min_len: 1, max_len: 4000}
  ];
  double distance = 6 [(buf.validate.field).double = {gte: 0}];
  optional double latitude = 7 [(buf.validate.field).double = {gte: -90, lte: 90}];
  optional double longitude = 8 [(buf.validate.field).double = {gte: -180, lte: 180}];
  string category = 9 [(buf.validate.field).string = {min_len: 1, max_len: 200}];
  string description = 10 [(buf.validate.field).string = {min_len: 1, max_len: 4000}];
  double rating = 11 [(buf.validate.field).double = {gte: 0, lte: 5}];
  string address = 12 [(buf.validate.field).string = {min_len: 1, max_len: 500}];
  string phone_number = 13 [(buf.validate.field).string = {
    min_len: 1,
    max_len: 50,
    pattern: "^\\+?[1-9]\\d{1,14}$"  // E.164 international phone format
  }];
  string website = 14 [(buf.validate.field).string = {
    min_len: 1,
    max_len: 2048,
    uri: true  // URL validation
  }];
  map<string, string> opening_hours = 15 [(buf.validate.field).map = {
    keys: {string: {min_len: 1}},
    values: {string: {min_len: 1}
    }
  }];
  repeated string images = 16 [(buf.validate.field).repeated = {
    max_items: 20,
    items: {string: {min_len: 1, max_len: 2048, uri: true}}
  }];
  string price_range = 17 [(buf.validate.field).string = {min_len: 1, max_len: 50}];
  string price_level = 18 [(buf.validate.field).string = {min_len: 1, max_len: 50}];
  repeated string reviews = 19 [(buf.validate.field).repeated = {
    max_items: 100,
    items: {string: {min_len: 1, max_len: 2000}}
  }];
  string llm_interaction_id = 20 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
  repeated string tags = 21 [(buf.validate.field).repeated = {
    max_items: 30,
    items: {string: {min_len: 1, max_len: 100}}
  }];
  optional int32 priority = 22 [(buf.validate.field).int32 = {gte: 0}];
  google.protobuf.Timestamp created_at = 23 [(buf.validate.field).required = true];
  optional string cuisine_type = 24 [(buf.validate.field).string = {min_len: 1, max_len: 100}
  ]; // For restaurants
  optional string star_rating = 25 [(buf.validate.field).string = {min_len: 1, max_len: 20}
  ];  // For hotels
  string amenities = 26 [(buf.validate.field).string = {min_len: 1, max_len: 2000}];
  optional string source = 27 [(buf.validate.field).string = {min_len: 1, max_len: 100}
  ];
}

// HotelDetailedInfo represents hotel-specific information
message HotelDetailedInfo {
  string id = 1 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
  string city = 2 [(buf.validate.field).string = {min_len: 1, max_len: 200}];
  string name = 3 [(buf.validate.field).string = {min_len: 1, max_len: 300}];
  double latitude = 4 [(buf.validate.field).double = {gte: -90, lte: 90}];
  double longitude = 5 [(buf.validate.field).double = {gte: -180, lte: 180}];
  string category = 6 [(buf.validate.field).string = {min_len: 1, max_len: 200}];
  string description = 7 [(buf.validate.field).string = {min_len: 1, max_len: 4000}];
  string address = 8 [(buf.validate.field).string = {min_len: 1, max_len: 500}];
  optional string phone_number = 9 [(buf.validate.field).string = {
    min_len: 1,
    max_len: 50,
    pattern: "^\\+?[1-9]\\d{1,14}$"  // E.164 international phone format
  }];
  optional string website = 10 [(buf.validate.field).string = {
    min_len: 1,
    max_len: 2048,
    uri: true  // URL validation
  }];
  optional string opening_hours = 11 [(buf.validate.field).string = {min_len: 1, max_len: 500}
  ];
  optional string price_range = 12 [(buf.validate.field).string = {min_len: 1, max_len: 50}
  ];
  double rating = 13 [(buf.validate.field).double = {gte: 0, lte: 5}];
  repeated string tags = 14 [(buf.validate.field).repeated = {
    max_items: 30,
    items: {string: {min_len: 1, max_len: 100}}
  }];
  repeated string images = 15 [(buf.validate.field).repeated = {
    max_items: 20,
    items: {string: {min_len: 1, max_len: 2048, uri: true}}
  }];
  string llm_interaction_id = 16 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
}

// RestaurantDetailedInfo represents restaurant-specific information
message RestaurantDetailedInfo {
  string id = 1 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
  string city = 2 [(buf.validate.field).string = {min_len: 1, max_len: 200}];
  string name = 3 [(buf.validate.field).string = {min_len: 1, max_len: 300}];
  double latitude = 4 [(buf.validate.field).double = {gte: -90, lte: 90}];
  double longitude = 5 [(buf.validate.field).double = {gte: -180, lte: 180}];
  string category = 6 [(buf.validate.field).string = {min_len: 1, max_len: 200}];
  string description = 7 [(buf.validate.field).string = {min_len: 1, max_len: 4000}];
  optional string address = 8 [(buf.validate.field).string = {min_len: 1, max_len: 500}
  ];
  optional string website = 9 [(buf.validate.field).string = {
    min_len: 1,
    max_len: 2048,
    uri: true  // URL validation
  }];
  optional string phone_number = 10 [(buf.validate.field).string = {
    min_len: 1,
    max_len: 50,
    pattern: "^\\+?[1-9]\\d{1,14}$"  // E.164 international phone format
  }];
  optional string opening_hours = 11 [(buf.validate.field).string = {min_len: 1, max_len: 500}
  ];
  optional string price_level = 12 [(buf.validate.field).string = {min_len: 1, max_len: 50}
  ];
  optional string cuisine_type = 13 [(buf.validate.field).string = {min_len: 1, max_len: 100}
  ];
  repeated string tags = 14 [(buf.validate.field).repeated = {
    max_items: 30,
    items: {string: {min_len: 1, max_len: 100}}
  }];
  repeated string images = 15 [(buf.validate.field).repeated = {
    max_items: 20,
    items: {string: {min_len: 1, max_len: 2048, uri: true}}
  }];
  double rating = 16 [(buf.validate.field).double = {gte: 0, lte: 5}];
  string llm_interaction_id = 17 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
}

// POIFilters for filtering POIs
message POIFilters {
  optional string city = 1 [(buf.validate.field).string = {min_len: 1, max_len: 200}
  ];
  optional string category = 2 [(buf.validate.field).string = {min_len: 1, max_len: 200}
  ];
  optional string price_range = 3 [(buf.validate.field).string = {min_len: 1, max_len: 50}
  ];
}

// SearchPOIRequest for searching POIs
message SearchPOIRequest {
  string query = 1 [(buf.validate.field).string = {min_len: 1, max_len: 500}];
  string city_name = 2 [(buf.validate.field).string = {min_len: 1, max_len: 200}];
  double latitude = 3 [(buf.validate.field).double = {gte: -90, lte: 90}];
  double longitude = 4 [(buf.validate.field).double = {gte: -180, lte: 180}];
  optional double radius_km = 5 [(buf.validate.field).double = {gt: 0}];
  optional string search_text = 6 [(buf.validate.field).string = {min_len: 1, max_len: 500}
  ];
  repeated string search_tags = 7 [(buf.validate.field).repeated = {
    max_items: 20,
    items: {string: {min_len: 1, max_len: 100}}
  }];
  optional string search_type = 8 [(buf.validate.field).string = {min_len: 1, max_len: 100}
  ];
  optional string sort_by = 9 [(buf.validate.field).string = {min_len: 1, max_len: 100}
  ];
  optional string sort_order = 10 [(buf.validate.field).string = {in: ["asc", "desc"]}
  ];
  optional double min_rating = 11 [(buf.validate.field).double = {gte: 0, lte: 5}];
  optional string min_price = 12 [(buf.validate.field).string = {min_len: 1, max_len: 50}
  ];
  optional int32 min_guests = 13 [(buf.validate.field).int32 = {gte: 1}];
}

// SearchPOIResponse for POI search results
message SearchPOIResponse {
  repeated POIDetailedInfo pois = 1;
  loci.common.PaginationMetadata pagination = 2;
}

// GetPOIRequest for retrieving POI details
message GetPOIRequest {
  string poi_id = 1 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
}

// GetPOIResponse for POI details retrieval
message GetPOIResponse {
  POIDetailedInfo poi = 1;
}

// AddPoiRequest for adding a POI to a list
message AddPoiRequest {
  string poi_id = 1 [(buf.validate.field).string = {min_len: 1, max_len: 100}];
  bool is_llm_poi = 2;
  optional POIDetailedInfo poi_data = 3;
}

// POIService defines POI-related RPCs
service POIService {
  rpc SearchPOI(SearchPOIRequest) returns (SearchPOIResponse);
  rpc GetPOI(GetPOIRequest) returns (GetPOIResponse);
}
